<!DOCTYPE html>
<html lang="pt-BR" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pitchutcha Docs</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

    <style>
        /* :root Variables and Global Styles */
        :root {
            --color-bg: #ffffff; --color-bg-inset: #f6f8fa; --color-border: #d0d7de; --color-text-primary: #1f2328; --color-text-secondary: #656d76; --color-accent: #0969da;
            --color-callout-note-bg: #ddf4ff; --color-callout-note-border: #96d3ff; --color-callout-warning-bg: #fff8c5; --color-callout-warning-border: #f4d35e;
            --header-height: 60px; --shadow-medium: 0 8px 24px rgba(140, 149, 159, 0.2);
        }
        html[data-theme="dark"] {
            --color-bg: #0d1117; --color-bg-inset: #161b22; --color-border: #30363d; --color-text-primary: #c9d1d9; --color-text-secondary: #8b949e; --color-accent: #58a6ff;
            --color-callout-note-bg: rgba(56, 139, 253, 0.15); --color-callout-note-border: #388bfd; --color-callout-warning-bg: rgba(240, 180, 5, 0.15); --color-callout-warning-border: #f0b405;
            --shadow-medium: 0 8px 24px rgba(1, 4, 9, 0.4);
        }
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { font-family: 'Inter', sans-serif; background-color: var(--color-bg); color: var(--color-text-primary); line-height: 1.6; }
        .is-hidden { display: none !important; }

        /* General UI Structure */
        .container { display: flex; flex-direction: column; min-height: 100vh; }
        .main-wrapper { display: flex; flex-grow: 1; justify-content: center; }
        .header { display: flex; align-items: center; padding: 0 24px; height: var(--header-height); border-bottom: 1px solid var(--color-border); background-color: var(--color-bg-inset); position: sticky; top: 0; z-index: 200; }
        .main-content { flex-grow: 1; padding: 24px 48px; max-width: 900px; }
        
        /* Sidebar (Left Navigation) */
        .sidebar { width: 280px; flex-shrink: 0; border-right: 1px solid var(--color-border); padding: 24px; display: flex; flex-direction: column; height: calc(100vh - var(--header-height)); position: sticky; top: var(--header-height); background-color: var(--color-bg); }
        .sidebar-nav a.active { background-color: var(--color-link-active-bg); color: var(--color-accent); font-weight: 600; }
        
        /* TOC Sidebar (Right) */
        .toc-sidebar { width: 250px; flex-shrink: 0; font-size: 0.85rem; padding: 24px; height: calc(100vh - var(--header-height)); position: sticky; top: var(--header-height); }
        .toc-sidebar a.active { color: var(--color-accent); font-weight: 500; border-left-color: var(--color-accent); }

        /* Article Content Styles */
        #content-area img { max-width: 100%; border-radius: 6px; cursor: zoom-in; }
        #article-meta { display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px; padding-bottom: 16px; border-bottom: 1px solid var(--color-border); font-size: 0.85rem; color: var(--color-text-secondary); }
        #article-meta a { color: var(--color-text-secondary); text-decoration: none; }
        #article-meta a:hover { color: var(--color-accent); text-decoration: underline; }

        /* Prev/Next Article Navigation */
        .article-navigation { display: flex; justify-content: space-between; margin-top: 48px; padding-top: 24px; border-top: 1px solid var(--color-border); }
        .article-navigation a { display: block; border: 1px solid var(--color-border); border-radius: 8px; padding: 16px; text-decoration: none; max-width: 48%; }
        .article-navigation a:hover { border-color: var(--color-accent); }
        .article-navigation .nav-label { font-size: 0.8rem; color: var(--color-text-secondary); }
        .article-navigation .nav-title { color: var(--color-text-primary); font-weight: 500; }
        .article-navigation .next { text-align: right; }

        /* Feedback Widget */
        .feedback-widget { text-align: center; margin-top: 48px; padding: 24px; border: 1px solid var(--color-border); border-radius: 8px; background-color: var(--color-bg-inset); }
        .feedback-widget button { background: var(--color-bg); border: 1px solid var(--color-border); border-radius: 6px; padding: 8px 16px; cursor: pointer; margin: 0 8px; }

        /* Command Palette (Ctrl+K) */
        .command-palette-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 999; }
        .command-palette { position: fixed; top: 20%; left: 50%; transform: translateX(-50%); width: 90%; max-width: 600px; background: var(--color-bg); border-radius: 8px; box-shadow: var(--shadow-medium); overflow: hidden; }
        .command-palette input { width: 100%; padding: 16px; font-size: 1.1rem; border: none; border-bottom: 1px solid var(--color-border); background: transparent; color: var(--color-text-primary); outline: none; }
        .command-palette-results { max-height: 300px; overflow-y: auto; }
        .command-palette-results li { padding: 12px 16px; cursor: pointer; border-bottom: 1px solid var(--color-border); }
        .command-palette-results li:last-child { border-bottom: none; }
        .command-palette-results li.selected { background-color: var(--color-accent); color: white; }
        .command-palette-results li.selected small { color: rgba(255,255,255,0.8); }
        .command-palette-results li small { display: block; color: var(--color-text-secondary); font-size: 0.8rem; }
        
        /* Image Lightbox */
        .lightbox-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 1000; display: flex; align-items: center; justify-content: center; cursor: zoom-out; }
        .lightbox-overlay img { max-width: 90%; max-height: 90%; display: block; }
        
        /* Print Styles */
        @media print {
            .header, .sidebar, .toc-sidebar, .article-navigation, .feedback-widget, #article-meta a { display: none; }
            body { background-color: #fff; color: #000; }
            .main-wrapper, .main-content { display: block; padding: 0; }
            #content-area a::after { content: " (" attr(href) ")"; }
        }

        /* Responsive Styles */
        @media (max-width: 1200px) { .toc-sidebar { display: none; } }
        @media (max-width: 768px) { .sidebar { position: fixed; z-index: 300; transform: translateX(-100%); } .sidebar.is-open { transform: translateX(0); } /* etc... */ }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header, Sidebar, etc. here -->
        <header class="header"><!-- Header content --></header>
        <div class="main-wrapper">
            <div class="sidebar-backdrop" id="sidebar-backdrop"></div>
            <aside class="sidebar" id="sidebar"><!-- Sidebar content --></aside>
            <main class="main-content">
                <div id="breadcrumbs"></div>
                <div id="article-meta" class="is-hidden">
                    <span id="last-updated"></span>
                    <a id="edit-on-github" href="#" target="_blank" rel="noopener noreferrer">Editar esta página no GitHub</a>
                </div>
                <div id="content-area"></div>
                <div id="article-navigation" class="article-navigation is-hidden"></div>
                <div id="feedback-widget" class="feedback-widget is-hidden"></div>
            </main>
            <aside class="toc-sidebar" id="toc-sidebar"></aside>
        </div>
    </div>

    <!-- Modals at the end of body -->
    <div class="command-palette-overlay is-hidden" id="command-palette-overlay">
        <div class="command-palette" role="dialog" aria-modal="true">
            <input type="text" id="command-palette-input" placeholder="Escreva um comando ou pesquise...">
            <ul class="command-palette-results" id="command-palette-results"></ul>
        </div>
    </div>
    <div class="lightbox-overlay is-hidden" id="lightbox-overlay">
        <img src="" alt="Imagem ampliada">
    </div>

    <script>
    document.addEventListener('DOMContentLoaded', () => {
        // --- State and Config ---
        const navLinks = Array.from(document.querySelectorAll('#sidebar-nav .nav-link'));
        const lastUpdatedDates = {
            'posts/introduction.md': '2025-09-12', 'posts/getting-started.md': '2025-09-14',
            'posts/api-reference.md': '2025-09-13', 'posts/advanced-concepts.md': '2025-09-11'
        };
        const GITHUB_BASE_URL = 'https://github.com/usuario/pitchutcha-docs/blob/main/';

        // --- UI Elements ---
        const contentArea = document.getElementById('content-area');
        const articleMeta = document.getElementById('article-meta');
        const articleNavigation = document.getElementById('article-navigation');
        const feedbackWidget = document.getElementById('feedback-widget');
        const commandPaletteOverlay = document.getElementById('command-palette-overlay');
        const commandPaletteInput = document.getElementById('command-palette-input');
        const lightboxOverlay = document.getElementById('lightbox-overlay');

        // --- Core Functions ---
        const loadContent = async (path) => {
            try {
                contentArea.innerHTML = '<h1>A carregar...</h1>';
                const response = await fetch(path);
                if (!response.ok) throw new Error('Falha na rede');
                const markdown = await response.text();
                contentArea.innerHTML = marked.parse(markdown);
                postRenderSetup(path);
            } catch (error) { contentArea.innerHTML = `<h1>Erro ao Carregar</h1>`; }
        };

        const displayLandingPage = () => {
            contentArea.innerHTML = `<!-- HTML da Landing Page aqui -->`;
            // Hide article-specific elements
            articleMeta.classList.add('is-hidden');
            articleNavigation.classList.add('is-hidden');
            feedbackWidget.classList.add('is-hidden');
            document.getElementById('toc-sidebar').innerHTML = '';
            document.getElementById('breadcrumbs').innerHTML = '';
        };

        const postRenderSetup = (path) => {
            // Show article-specific elements
            articleMeta.classList.remove('is-hidden');
            articleNavigation.classList.remove('is-hidden');
            feedbackWidget.classList.remove('is-hidden');
            
            // Generate all the new features
            generateArticleMeta(path);
            generatePrevNext(path);
            generateFeedbackWidget();
            
            // Existing features
            // ... breadcrumbs, callouts, copy buttons, TOC ...
            
            // Add Lightbox functionality to new images
            contentArea.querySelectorAll('img').forEach(img => {
                img.addEventListener('click', () => openLightbox(img.src));
            });
        };

        // --- FEATURE 1: Prev/Next Navigation ---
        const generatePrevNext = (path) => {
            const currentIndex = navLinks.findIndex(link => link.getAttribute('href') === path);
            let prevHTML = '', nextHTML = '';
            if (currentIndex > 0) {
                const prevLink = navLinks[currentIndex - 1];
                prevHTML = `<a href="${prevLink.href}" class="prev nav-link"><div class="nav-label">Anterior</div><div class="nav-title">${prevLink.textContent}</div></a>`;
            }
            if (currentIndex < navLinks.length - 1) {
                const nextLink = navLinks[currentIndex + 1];
                nextHTML = `<a href="${nextLink.href}" class="next nav-link"><div class="nav-label">Próximo</div><div class="nav-title">${nextLink.textContent}</div></a>`;
            }
            articleNavigation.innerHTML = prevHTML + nextHTML;
            articleNavigation.querySelectorAll('.nav-link').forEach(link => link.addEventListener('click', (e) => handleNavClick(e, link)));
        };

        // --- FEATURE 2 & 3: Article Meta (Edit Link & Last Updated) ---
        const generateArticleMeta = (path) => {
            document.getElementById('edit-on-github').href = GITHUB_BASE_URL + path;
            const updatedDate = lastUpdatedDates[path] || new Date().toLocaleDateString('pt-PT');
            document.getElementById('last-updated').textContent = `Última atualização: ${updatedDate}`;
        };

        // --- FEATURE 4: Command Palette ---
        const openCommandPalette = () => { commandPaletteOverlay.classList.remove('is-hidden'); commandPaletteInput.focus(); };
        const closeCommandPalette = () => { commandPaletteOverlay.classList.add('is-hidden'); };
        window.addEventListener('keydown', (e) => {
            if ((e.ctrlKey || e.metaKey) && e.key === 'k') { e.preventDefault(); openCommandPalette(); }
            if (e.key === 'Escape') { closeCommandPalette(); closeLightbox(); }
        });
        // ... more command palette logic for search and navigation ...

        // --- FEATURE 5: Feedback Widget ---
        const generateFeedbackWidget = () => {
            feedbackWidget.innerHTML = `
                <p>Esta página foi útil?</p>
                <button id="feedback-yes">Sim</button> <button id="feedback-no">Não</button>
            `;
            feedbackWidget.querySelector('#feedback-yes').addEventListener('click', () => {
                feedbackWidget.innerHTML = `<p>Obrigado pelo seu feedback!</p>`;
            });
            feedbackWidget.querySelector('#feedback-no').addEventListener('click', () => {
                feedbackWidget.innerHTML = `<p>Obrigado pelo seu feedback!</p>`;
            });
        };

        // --- FEATURE 6: Image Lightbox ---
        const openLightbox = (src) => {
            lightboxOverlay.querySelector('img').src = src;
            lightboxOverlay.classList.remove('is-hidden');
        };
        const closeLightbox = () => { lightboxOverlay.classList.add('is-hidden'); };
        lightboxOverlay.addEventListener('click', closeLightbox);
        
        // --- Navigation Handling ---
        const handleNavClick = (e, target) => {
            e.preventDefault();
            const path = target.getAttribute('href');
            loadContent(path);
            // ... update active link, history, etc ...
        };

        // --- Initialisation ---
        displayLandingPage();
        // ... add all other event listeners ...
    });
    </script>
</body>
</html>

